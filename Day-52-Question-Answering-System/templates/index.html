<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Question Answering | Day 52</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        
        :root {
            --primary: #6366f1;
            --primary-light: #818cf8;
            --accent: #22d3ee;
            --success: #10b981;
            --bg-dark: #0f0f1a;
            --bg-card: rgba(30, 30, 50, 0.6);
        }
        
        body {
            background: var(--bg-dark);
            background-image: 
                radial-gradient(ellipse at 20% 0%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(34, 211, 238, 0.1) 0%, transparent 50%);
            min-height: 100vh;
        }
        
        /* Glass Card */
        .glass {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        /* Progress Steps */
        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 1;
        }
        
        .step-item:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 60%;
            width: 80%;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .step-item.active:not(:last-child)::after,
        .step-item.completed:not(:last-child)::after {
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }
        
        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.4);
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }
        
        .step-item.active .step-circle {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-color: transparent;
            color: white;
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
        }
        
        .step-item.completed .step-circle {
            background: var(--success);
            border-color: transparent;
            color: white;
        }
        
        .step-label {
            margin-top: 8px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.4);
            font-weight: 500;
        }
        
        .step-item.active .step-label,
        .step-item.completed .step-label {
            color: rgba(255, 255, 255, 0.8);
        }
        
        /* Mode Pills */
        .mode-pill {
            padding: 12px 24px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .mode-pill:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.15);
        }
        
        .mode-pill.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
        }
        
        /* Input Styles */
        .input-area {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            transition: all 0.3s ease;
        }
        
        .input-area:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
        }
        
        .input-area textarea {
            background: transparent;
            border: none;
            outline: none;
            resize: none;
            color: white;
            width: 100%;
        }
        
        .input-area textarea::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }
        
        /* Primary Button */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), #7c3aed);
            color: white;
            font-weight: 600;
            padding: 16px 32px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Sample Cards */
        .sample-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .sample-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .sample-card .emoji {
            font-size: 32px;
            margin-bottom: 12px;
        }
        
        /* Answer Box */
        .answer-box {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(34, 211, 238, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
        }
        
        .answer-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--primary), var(--accent));
        }
        
        /* Confidence Bar */
        .confidence-track {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 4px;
            transition: width 1s ease-out;
        }
        
        /* Loading Animation */
        .loading-dots {
            display: flex;
            gap: 6px;
            justify-content: center;
        }
        
        .loading-dots span {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        
        .loading-dots span:nth-child(1) { 
            background: var(--primary);
            animation-delay: -0.32s; 
        }
        .loading-dots span:nth-child(2) { 
            background: var(--accent);
            animation-delay: -0.16s; 
        }
        .loading-dots span:nth-child(3) { 
            background: var(--success);
        }
        
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        
        /* Quick Question Pills */
        .quick-pill {
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }
        
        .quick-pill:hover {
            background: rgba(99, 102, 241, 0.2);
            color: white;
            border-color: var(--primary);
        }
        
        /* Comparison Cards */
        .comparison-card {
            border-radius: 20px;
            padding: 24px;
            position: relative;
            overflow: hidden;
        }
        
        .comparison-card.extractive {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(34, 211, 238, 0.1));
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .comparison-card.generative {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(236, 72, 153, 0.1));
            border: 1px solid rgba(168, 85, 247, 0.2);
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 16px 24px;
            border-radius: 12px;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { 
            background: rgba(255, 255, 255, 0.1); 
            border-radius: 3px; 
        }
        ::-webkit-scrollbar-thumb:hover { 
            background: rgba(255, 255, 255, 0.2); 
        }
        
        /* Highlight */
        .highlight {
            background: linear-gradient(90deg, rgba(99, 102, 241, 0.3), rgba(34, 211, 238, 0.3));
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        /* Fade In Animation */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Tooltip */
        .tooltip {
            position: relative;
        }
        
        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            font-size: 12px;
            border-radius: 8px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            margin-bottom: 8px;
        }
        
        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }
        
        /* Character Counter */
        .char-counter {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.3);
        }
        
        .char-counter.warning {
            color: #fbbf24;
        }
        
        .char-counter.good {
            color: var(--success);
        }
    </style>
</head>
<body class="text-white antialiased">
    <div class="min-h-screen py-6 px-4 sm:px-6 lg:px-8">
        <div class="max-w-5xl mx-auto">
            
            <!-- Header -->
            <header class="text-center mb-8">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-cyan-500 mb-4 shadow-lg shadow-indigo-500/30">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <h1 class="text-3xl sm:text-4xl font-bold mb-2">
                    <span class="bg-gradient-to-r from-indigo-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent">
                        AI Question Answering
                    </span>
                </h1>
                <p class="text-gray-400 text-sm">
                    Day 52 ‚Ä¢ Extractive & Generative QA with DistilBERT + BART
                </p>
            </header>

            <!-- Progress Steps -->
            <div class="flex justify-center mb-8">
                <div class="flex items-start w-full max-w-md">
                    <div class="step-item" id="step1">
                        <div class="step-circle">1</div>
                        <span class="step-label">Add Context</span>
                    </div>
                    <div class="step-item" id="step2">
                        <div class="step-circle">2</div>
                        <span class="step-label">Ask Question</span>
                    </div>
                    <div class="step-item" id="step3">
                        <div class="step-circle">3</div>
                        <span class="step-label">Get Answer</span>
                    </div>
                </div>
            </div>

            <!-- Mode Selection -->
            <div class="glass rounded-2xl p-5 mb-6">
                <div class="flex flex-wrap items-center justify-between gap-4">
                    <div>
                        <h2 class="text-sm font-semibold text-gray-300 mb-1">Select Mode</h2>
                        <p class="text-xs text-gray-500" id="modeHint">Extractive finds exact answers, Generative creates new text</p>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="setMode('extractive')" class="mode-pill active" data-mode="extractive">
                            üéØ Extractive
                        </button>
                        <button onclick="setMode('generative')" class="mode-pill" data-mode="generative">
                            ‚ú® Generative
                        </button>
                        <button onclick="setMode('hybrid')" class="mode-pill" data-mode="hybrid">
                            ‚öñÔ∏è Compare Both
                        </button>
                    </div>
                </div>
            </div>

            <!-- Main Input Section -->
            <div class="glass rounded-2xl p-6 mb-6">
                <!-- Context Section -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-3">
                        <label class="text-sm font-semibold text-gray-300 flex items-center gap-2">
                            <span class="w-6 h-6 rounded-full bg-cyan-500/20 flex items-center justify-center text-cyan-400 text-xs font-bold">1</span>
                            Context Passage
                        </label>
                        <span class="char-counter" id="contextCounter">0 chars</span>
                    </div>
                    <div class="input-area p-4">
                        <textarea 
                            id="contextInput" 
                            class="h-40 text-sm leading-relaxed"
                            placeholder="Paste or type the text passage here. This is the source from which the AI will find or generate answers..."
                            oninput="handleContextInput()"
                        ></textarea>
                    </div>
                    
                    <!-- Sample Context Buttons -->
                    <div class="mt-3">
                        <p class="text-xs text-gray-500 mb-2">Or try a sample:</p>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="loadSample('science')" class="sample-btn px-3 py-1.5 text-xs rounded-lg bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 hover:bg-emerald-500/20 transition-all">
                                üî¨ Science
                            </button>
                            <button onclick="loadSample('history')" class="sample-btn px-3 py-1.5 text-xs rounded-lg bg-amber-500/10 border border-amber-500/20 text-amber-400 hover:bg-amber-500/20 transition-all">
                                üìú History
                            </button>
                            <button onclick="loadSample('technology')" class="sample-btn px-3 py-1.5 text-xs rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-400 hover:bg-blue-500/20 transition-all">
                                üíª Technology
                            </button>
                            <button onclick="loadSample('literature')" class="sample-btn px-3 py-1.5 text-xs rounded-lg bg-pink-500/10 border border-pink-500/20 text-pink-400 hover:bg-pink-500/20 transition-all">
                                üìö Literature
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Question Section -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-3">
                        <label class="text-sm font-semibold text-gray-300 flex items-center gap-2">
                            <span class="w-6 h-6 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400 text-xs font-bold">2</span>
                            Your Question
                        </label>
                    </div>
                    <div class="input-area p-4">
                        <textarea 
                            id="questionInput" 
                            class="h-20 text-sm"
                            placeholder="What would you like to know about the context above?"
                            oninput="handleQuestionInput()"
                        ></textarea>
                    </div>
                    
                    <!-- Quick Questions -->
                    <div id="quickQuestionsBox" class="mt-3 hidden">
                        <p class="text-xs text-gray-500 mb-2">üí° Suggested questions:</p>
                        <div class="flex flex-wrap gap-2" id="quickQuestions"></div>
                    </div>
                </div>

                <!-- Submit Button -->
                <button 
                    id="askBtn"
                    onclick="askQuestion()" 
                    class="btn-primary w-full text-base"
                    disabled
                >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Get Answer
                </button>
            </div>

            <!-- Loading State -->
            <div id="loadingState" class="hidden glass rounded-2xl p-8 mb-6 text-center fade-in">
                <div class="loading-dots mb-4">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <p class="text-gray-400 text-sm" id="loadingText">Analyzing context...</p>
                <p class="text-gray-600 text-xs mt-2">This may take a moment for longer passages</p>
            </div>

            <!-- Answer Section (Single Mode) -->
            <div id="answerSection" class="hidden mb-6">
                <div class="glass rounded-2xl p-6 fade-in">
                    <!-- Answer Header -->
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <h2 class="font-semibold">Answer</h2>
                                <p class="text-xs text-gray-500">
                                    <span id="answerMode">Extractive</span> ‚Ä¢ 
                                    <span id="modelName">DistilBERT</span> ‚Ä¢ 
                                    <span id="answerTime">0.5s</span>
                                </p>
                            </div>
                        </div>
                        <button onclick="copyAnswer()" class="tooltip p-2 rounded-lg hover:bg-white/5 transition-all" data-tip="Copy answer">
                            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- Answer Content -->
                    <div class="answer-box mb-4">
                        <p id="answerText" class="text-lg font-medium leading-relaxed"></p>
                    </div>

                    <!-- Confidence -->
                    <div class="mb-4">
                        <div class="flex justify-between text-sm mb-2">
                            <span class="text-gray-400">Confidence Score</span>
                            <span id="confidenceValue" class="font-semibold text-emerald-400">85%</span>
                        </div>
                        <div class="confidence-track">
                            <div id="confidenceBar" class="confidence-fill" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Highlighted Context -->
                    <div id="highlightedSection" class="hidden">
                        <div class="flex items-center gap-2 mb-2">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="text-sm text-gray-400">Answer in context</span>
                        </div>
                        <div id="highlightedContext" class="text-sm text-gray-300 leading-relaxed p-4 rounded-xl bg-black/20"></div>
                    </div>

                    <!-- Ask Another -->
                    <button onclick="resetQuestion()" class="mt-4 w-full py-3 rounded-xl border border-gray-600 text-gray-400 hover:border-indigo-500 hover:text-indigo-400 transition-all flex items-center justify-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        Ask Another Question
                    </button>
                </div>
            </div>

            <!-- Hybrid Answer Section -->
            <div id="hybridSection" class="hidden mb-6 fade-in">
                <div class="grid md:grid-cols-2 gap-4 mb-4">
                    <!-- Extractive -->
                    <div class="comparison-card extractive glass">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center">
                                üéØ
                            </div>
                            <div>
                                <h3 class="font-semibold">Extractive</h3>
                                <p class="text-xs text-gray-500">DistilBERT-SQuAD</p>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl bg-black/20 mb-4">
                            <p id="extractiveAnswer" class="font-medium"></p>
                        </div>
                        <div class="flex justify-between items-center text-sm">
                            <span class="text-gray-400">Confidence</span>
                            <span id="extractiveConfidence" class="font-semibold text-cyan-400">0%</span>
                        </div>
                        <div class="confidence-track mt-2">
                            <div id="extractiveBar" class="confidence-fill" style="width: 0%; background: linear-gradient(90deg, #3b82f6, #22d3ee)"></div>
                        </div>
                    </div>

                    <!-- Generative -->
                    <div class="comparison-card generative glass">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
                                ‚ú®
                            </div>
                            <div>
                                <h3 class="font-semibold">Generative</h3>
                                <p class="text-xs text-gray-500">BART-large-CNN</p>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl bg-black/20 mb-4">
                            <p id="generativeAnswer" class="font-medium"></p>
                        </div>
                        <div class="flex justify-between items-center text-sm">
                            <span class="text-gray-400">Relevance</span>
                            <span id="generativeConfidence" class="font-semibold text-purple-400">0%</span>
                        </div>
                        <div class="confidence-track mt-2">
                            <div id="generativeBar" class="confidence-fill" style="width: 0%; background: linear-gradient(90deg, #a855f7, #ec4899)"></div>
                        </div>
                    </div>
                </div>

                <!-- Recommendation -->
                <div class="glass rounded-xl p-4">
                    <div class="flex items-start gap-3">
                        <div class="w-8 h-8 rounded-lg bg-emerald-500/20 flex items-center justify-center flex-shrink-0">
                            <svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-semibold text-sm text-emerald-400 mb-1">AI Recommendation</h4>
                            <p id="recommendation" class="text-sm text-gray-300"></p>
                        </div>
                    </div>
                </div>

                <!-- Ask Another -->
                <button onclick="resetQuestion()" class="mt-4 w-full py-3 rounded-xl border border-gray-600 text-gray-400 hover:border-indigo-500 hover:text-indigo-400 transition-all flex items-center justify-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Ask Another Question
                </button>
            </div>

            <!-- Footer -->
            <footer class="text-center text-gray-600 text-xs mt-8">
                <p>Day 52 of 100 Days of AI ‚Ä¢ Powered by Abdul Rehman Baig With ‚ù§Ô∏è</p>
            </footer>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast">
        <svg class="w-5 h-5 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        <span id="toastMessage">Copied to clipboard!</span>
    </div>

    <script>
        // Sample data
        const samples = {
            science: {
                context: `Photosynthesis is a process used by plants and other organisms to convert light energy into chemical energy that can be stored and later released to fuel the organism's activities. This process takes place primarily in the chloroplasts of plant cells, specifically in structures called thylakoids. During photosynthesis, plants absorb carbon dioxide from the air through small pores called stomata and water from the soil through their roots. Using sunlight as an energy source, they convert these raw materials into glucose (a simple sugar) and oxygen. The overall chemical equation for photosynthesis is: 6CO2 + 6H2O + light energy ‚Üí C6H12O6 + 6O2. Chlorophyll, the green pigment in plants, plays a crucial role by absorbing light energy, primarily from the blue and red portions of the electromagnetic spectrum.`,
                questions: ["Where does photosynthesis take place?", "What is chlorophyll?", "What is the chemical equation for photosynthesis?"]
            },
            history: {
                context: `The Apollo 11 mission was the first crewed mission to land on the Moon. Commander Neil Armstrong and lunar module pilot Buzz Aldrin landed the Apollo Lunar Module Eagle on July 20, 1969, at 20:17 UTC. Armstrong became the first person to step onto the lunar surface six hours and 39 minutes later on July 21 at 02:56 UTC. Aldrin joined him 19 minutes later. They spent about two and a quarter hours together outside the spacecraft, and collected 47.5 pounds (21.5 kg) of lunar material to bring back to Earth. Command module pilot Michael Collins flew the Command Module Columbia alone in lunar orbit while they were on the Moon's surface. Armstrong's first step onto the lunar surface was broadcast on live TV to a worldwide audience, and he described the event as "one small step for man, one giant leap for mankind."`,
                questions: ["When did Apollo 11 land on the Moon?", "Who was the first person on the Moon?", "How much lunar material did they collect?"]
            },
            technology: {
                context: `Machine learning is a subset of artificial intelligence that focuses on building systems that can learn from and make decisions based on data. Unlike traditional programming where rules are explicitly coded, machine learning algorithms build mathematical models based on training data to make predictions or decisions without being explicitly programmed for the task. There are three main types of machine learning: supervised learning, where the algorithm learns from labeled data; unsupervised learning, where the algorithm finds patterns in unlabeled data; and reinforcement learning, where an agent learns to make decisions by interacting with an environment. Deep learning, a subset of machine learning, uses neural networks with multiple layers to learn hierarchical representations of data. Popular frameworks for machine learning include TensorFlow, PyTorch, and scikit-learn.`,
                questions: ["What is machine learning?", "What are the types of machine learning?", "What is deep learning?"]
            },
            literature: {
                context: `William Shakespeare was an English playwright and poet, widely regarded as the greatest writer in the English language and the world's greatest dramatist. He was born in Stratford-upon-Avon in 1564 and died there in 1616. Shakespeare wrote approximately 39 plays, 154 sonnets, and several longer poems. His plays have been translated into every major language and are performed more often than those of any other playwright. His works include famous tragedies such as Hamlet, Macbeth, Othello, and King Lear, as well as beloved comedies like A Midsummer Night's Dream, Much Ado About Nothing, and The Tempest. The Globe Theatre in London, associated with Shakespeare, was built in 1599 by his playing company, the Lord Chamberlain's Men.`,
                questions: ["When was Shakespeare born?", "How many plays did Shakespeare write?", "When was the Globe Theatre built?"]
            }
        };

        let currentMode = 'extractive';
        let currentAnswer = '';

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateSteps(1);
        });

        // Step Progress
        function updateSteps(activeStep) {
            for (let i = 1; i <= 3; i++) {
                const step = document.getElementById(`step${i}`);
                step.classList.remove('active', 'completed');
                if (i < activeStep) {
                    step.classList.add('completed');
                } else if (i === activeStep) {
                    step.classList.add('active');
                }
            }
        }

        // Mode Selection
        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-pill').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });
            
            const hints = {
                extractive: 'Finds exact answer spans from the text',
                generative: 'Creates natural language responses',
                hybrid: 'Compares both approaches side by side'
            };
            document.getElementById('modeHint').textContent = hints[mode];
        }

        // Handle Context Input
        function handleContextInput() {
            const context = document.getElementById('contextInput').value;
            const counter = document.getElementById('contextCounter');
            const len = context.length;
            
            counter.textContent = `${len} chars`;
            counter.classList.remove('warning', 'good');
            
            if (len > 0 && len < 100) {
                counter.classList.add('warning');
            } else if (len >= 100) {
                counter.classList.add('good');
            }
            
            updateButtonState();
            
            if (len > 0) {
                updateSteps(2);
            } else {
                updateSteps(1);
            }
        }

        // Handle Question Input
        function handleQuestionInput() {
            updateButtonState();
        }

        // Update Button State
        function updateButtonState() {
            const context = document.getElementById('contextInput').value.trim();
            const question = document.getElementById('questionInput').value.trim();
            const btn = document.getElementById('askBtn');
            
            btn.disabled = !(context && question);
        }

        // Load Sample
        function loadSample(key) {
            const sample = samples[key];
            document.getElementById('contextInput').value = sample.context;
            handleContextInput();
            
            // Show quick questions
            const container = document.getElementById('quickQuestions');
            container.innerHTML = '';
            sample.questions.forEach(q => {
                const pill = document.createElement('button');
                pill.className = 'quick-pill';
                pill.textContent = q;
                pill.onclick = () => {
                    document.getElementById('questionInput').value = q;
                    handleQuestionInput();
                };
                container.appendChild(pill);
            });
            document.getElementById('quickQuestionsBox').classList.remove('hidden');
            
            showToast('Sample loaded! Try one of the suggested questions.');
        }

        // Ask Question
        async function askQuestion() {
            const context = document.getElementById('contextInput').value.trim();
            const question = document.getElementById('questionInput').value.trim();
            
            if (!context || !question) return;

            // Show loading
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('answerSection').classList.add('hidden');
            document.getElementById('hybridSection').classList.add('hidden');
            document.getElementById('askBtn').disabled = true;
            
            updateSteps(3);
            
            const loadingTexts = [
                'Analyzing context...',
                'Processing question...',
                'Generating answer...',
                'Almost there...'
            ];
            let idx = 0;
            const loadingInterval = setInterval(() => {
                document.getElementById('loadingText').textContent = loadingTexts[idx % loadingTexts.length];
                idx++;
            }, 1500);

            try {
                const response = await fetch('/ask', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ context, question, mode: currentMode })
                });

                const data = await response.json();
                clearInterval(loadingInterval);

                if (data.error) {
                    showToast(data.error, true);
                    document.getElementById('loadingState').classList.add('hidden');
                    document.getElementById('askBtn').disabled = false;
                    return;
                }

                displayAnswer(data);
            } catch (error) {
                clearInterval(loadingInterval);
                showToast('An error occurred. Please try again.', true);
                console.error(error);
            }

            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('askBtn').disabled = false;
        }

        // Display Answer
        function displayAnswer(data) {
            if (data.mode === 'hybrid') {
                // Hybrid mode
                document.getElementById('answerSection').classList.add('hidden');
                document.getElementById('hybridSection').classList.remove('hidden');
                
                // Extractive
                document.getElementById('extractiveAnswer').textContent = data.extractive.answer;
                document.getElementById('extractiveConfidence').textContent = data.extractive.confidence + '%';
                setTimeout(() => {
                    document.getElementById('extractiveBar').style.width = data.extractive.confidence + '%';
                }, 100);
                
                // Generative
                document.getElementById('generativeAnswer').textContent = data.generative.answer;
                document.getElementById('generativeConfidence').textContent = data.generative.confidence + '%';
                setTimeout(() => {
                    document.getElementById('generativeBar').style.width = data.generative.confidence + '%';
                }, 100);
                
                // Recommendation
                document.getElementById('recommendation').textContent = data.recommendation;
                
                currentAnswer = `Extractive: ${data.extractive.answer}\n\nGenerative: ${data.generative.answer}`;
            } else {
                // Single mode
                document.getElementById('answerSection').classList.remove('hidden');
                document.getElementById('hybridSection').classList.add('hidden');
                
                currentAnswer = data.answer;
                document.getElementById('answerText').textContent = data.answer;
                document.getElementById('answerMode').textContent = data.mode.charAt(0).toUpperCase() + data.mode.slice(1);
                document.getElementById('answerTime').textContent = data.processing_time + 's';
                document.getElementById('confidenceValue').textContent = data.confidence + '%';
                document.getElementById('modelName').textContent = data.model;
                
                setTimeout(() => {
                    document.getElementById('confidenceBar').style.width = data.confidence + '%';
                }, 100);
                
                // Highlighted context
                if (data.mode === 'extractive' && data.highlighted_context) {
                    document.getElementById('highlightedSection').classList.remove('hidden');
                    document.getElementById('highlightedContext').innerHTML = data.highlighted_context;
                } else {
                    document.getElementById('highlightedSection').classList.add('hidden');
                }
            }

            // Scroll to answer
            setTimeout(() => {
                const target = data.mode === 'hybrid' ? 'hybridSection' : 'answerSection';
                document.getElementById(target).scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        // Copy Answer
        function copyAnswer() {
            navigator.clipboard.writeText(currentAnswer).then(() => {
                showToast('Answer copied to clipboard!');
            });
        }

        // Reset Question
        function resetQuestion() {
            document.getElementById('questionInput').value = '';
            document.getElementById('answerSection').classList.add('hidden');
            document.getElementById('hybridSection').classList.add('hidden');
            document.getElementById('confidenceBar').style.width = '0%';
            document.getElementById('extractiveBar').style.width = '0%';
            document.getElementById('generativeBar').style.width = '0%';
            updateSteps(2);
            document.getElementById('questionInput').focus();
        }

        // Show Toast
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            const msgEl = document.getElementById('toastMessage');
            
            msgEl.textContent = message;
            toast.querySelector('svg').style.color = isError ? '#ef4444' : '#10b981';
            
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Enter key handler
        document.getElementById('questionInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                if (!document.getElementById('askBtn').disabled) {
                    askQuestion();
                }
            }
        });
    </script>
</body>
</html>
